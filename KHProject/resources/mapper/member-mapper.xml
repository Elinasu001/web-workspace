<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="memberMapper">
	<!-- com.kh.java.member.model.vo.Member -->
	<select id="login" resultType="member" parameterType="member">
		SELECT
			  USER_NO userNo
			, USER_ID userId
			, USER_PWD userPwd
			, USER_NAME userName
			, EMAIL	
			, ENROLL_DATE enrollDate
			, MODIFY_DATE modifyDate
			, STATUS
		FROM
		      KH_MEMBER
		WHERE
		      USER_ID = #{userId}
		  AND
		      USER_PWD = #{userPwd}
		  AND
		      STATUS = 'Y'
	</select>
	
	<insert id="signUp"> <!-- parameterType :  Mybatis 라서 안적어도됨. -->
		INSERT
		  INTO
		       KH_MEMBER
		       (
		       USER_NO
		     , USER_ID
		     , USER_PWD
		     , USER_NAME
		     , EMAIL
		       )
		VALUES
			   (
			   KH_UNO.NEXTVAL
			 , #{userId}
			 , #{userPwd}
			 , #{userName}
			 , #{email}
			   )
	</insert>
	
	<update id="update"> <!-- parameterType :  Mybatis 라서 안적어도됨./ 적어주는게 좋긴 함.-->
		UPDATE
		       KH_MEMBER
		   SET
		       USER_NAME = #{userName}
		     , EMAIL = #{email}
		     , MODIFY_DATE = SYSDATE <!-- 갱신날짜 -->
		 WHERE
		       USER_NO = #{userNo}
		   AND
		       STATUS = 'Y'
	</update>
		
	
	<update id="delete">
		UPDATE
		       KH_MEMBER
		   SET
		       STATUS = 'N'	
		     , MODIFY_DATE = SYSDATE
		 WHERE
			   USER_NO = #{userNo}
		   AND
		       USER_PWD = #{userPwd}
		   AND
		       STATUS = 'Y'	   
	</update>
	<!-- STATUS = 'Y' : 이미 탈퇴한 회원(STATUS = 'N')을 중복 처리하지 않기 위해 / 현재 사용중인 정상 계정만 탈퇴 처리됨 -->
	
	<update id="updatePwd">
		UPDATE
		       KH_MEMBER
		   SET
		       USER_PWD = #{updatePwd}
		 WHERE
		       USER_NO = #{userNo}
	       AND
	           USER_PWD = #{userPwd}
	       AND 
	           STATUS = 'Y'
	</update>
	
	
</mapper>
